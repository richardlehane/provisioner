sudo: false
language: go
go:
- stable
env:
  global:
  - secure: 124cjTvzWF35bkF4PGwdnKWy5Z0KzduaXus2u991i0zCSwxJD4JR0lhqx1cMk5cSaXSaJafbO1AItJy7K1wpJE2q2qUtXDZ3YZKB+rna9wKToZJTDhi/+8JLmrOhXqtS/pIVC8NJblzrgBLXCm0MMAcFozVYrvzfjQ4Fing6d8SC12RuC+GwPGc7pjrVSvbCBqZwZEeeC/jFBEVjOa5Y846BQtzuKViBUWRPdU4qe3nO5n5I9lKX7Q3wtxU+RM+eaN7j3hPXXG8pMPDYRmAc+64m06TX1QgEed0yWQOsIr1pBCVFXS3Is/Jh3rZlfrRSBJvmMeMDacPL9ASSBdTvwfBerI9z0JoNqlav7VCuXx+By8JEyHeRcnEeeRB0bKFHNUtPovw1qICH0XqrlJE7q38xYxXPUV3TNZiRtaRLJtp0B7BN3UZur2yPVbU5G697d22DlZOrHs+i8Wxq7warjV2JGvNBOMaXxEXY9dq3zcbwGutYzF/Tb7Tr0uCcUxnDcyT90SOQBwiyxc2XUbvTacow8JdIxIRCgT9rSeCrTl/DDAg9ehI26SIKOu4UMI1ecATIiaFDGhfrGu4obMKkBbmdDOsyS6a7IZZXDH8PsgDbaPNb+W+d4pyUfIbKV2B6PcjwwCF6ppq63jhELz8npLvna1+/1bMv5v4XfYUvPzY=
  - secure: P2iO0j9+KftIIZI5Gnqn28WUHsxoGrLVH94zRxTyqwlZxn8tpw/inc8f6pC8PWGcf4rC2tHO4YwNlZjSEqbFju9dNbbipKE49UJn5yL/dZFmAouHOtfrxuloo+m0/n40V7J62bRaaAG7PD97IBP4JtrlqsItRr4Ut24ExGGZPFC5uD8AmkjzN7sVBOjJ4BB+M5mJO355F7rJeRXnArttw++x1GfecmI4yVxyEo8hUxr0SI8EStLqbQ+k0lhlXVlcILwL8qBJ1YPxacdzIR0w0bQbPv6Xh+SQmHJlnmsV4tnPhWGjt5vn+DFUHf6TgwSEWX3e2nVQROgGTisjtfLsf7DhqQk2YXzHhqPIqLL4ODjz5I/Cr6t3vI99ld20lrdbl2upp78ZlYlqdEV3bVKMQLNdsawBNMxe71IjQd9LYaX0GGH/vSMYYmwq72MABiaYISZZ0aaUF4pgalwCLsIXaRkUsTN67rR47dTxf9BOVKymQySvi96pSLDu1NcNCtizEhSYNhWsQF+8XOXT0XRZKCkVHqpK/yFGdgtvLnFrEOYvytiok35r1H8Z0VmQ1Tr3080QZHiH0Y0ANoBUqVmDYSST9ua0avwXkE7RwSWVcibPQ/FGjRl/iab8eId3sy8MwseeGJAv8t8piKqnkLZca2hRDNKECZ491/bsMeU43qE=
  - secure: WoMzvItKDrZcQs5m4VwgIL5lIfvfh6jVWaqe7CZ6fUFQGclrOnloLB9d/ni1T5lSCrmw+YbW8AzT1n5UKoGnZ5de5D4g8akCDhSKK50gABDwWFkxMoXneaCzKdSq4HpPXwKjcXyXTvPm07DQ4Q2kl6coZZ7N0WR8IrdujYecLBrY89kNkL3bGdkThDvghlvBuE/RNSgi6t1M0bRkxqCrl9eDrKvua982Lfh5oneO/LdGlOYc+/Ub7i4o4GwIqvHEWArt1vmoSMdaSBomxyoSoEttQELg0Zned8KMK3x0hGaZzbcOvPdIrMQr04Jz5idsx3/cnJAWP5wl/bSHRLEUX7HzqCbWak0T1VEGR7/2xrQNKEMAGt3/yulb6BJMlfI21MlUE1KnOgadSRkeVLT13mUl/Co0SRJwn1Gi5B9kWIxtzVarzkQFQWHz6sSBTwLM+4HJnxqxI+EgOFUQF5ttpKtQ1z0ngkWsF4s5Dv8tClPnc5rxUBbpo/6Nc1LZvIqza29a+jx1H5v8QcGJ1K2mex6JzdM88DfDKoED30maS//aXrckPMkvBC1s7WCxda9VRqJNHlkkSrrLs9oXJnZZezimQ5d5P7lWvyyUt9WILEb1KMZPPOLkW4EgBUY5USXCthlErqvjMOs1yCqFn9HgtHh36BgT9PtrxG+xEh9Zu54=
  - secure: gSmG/fWpZbapfcQ+tlMx4Mv/pDfa9uV4jW10JCXSB1uY/1TPNROL7BZHbG+1PDcvV4mx7HvQQtri7gYvF0Y4dQgmGd8etJuNdXJbS+yawa3s5yWcL2grqb0tVT36nKfidwMYd4AydUOlq68N/IJSe/fWwCw4V0Coa3APzqs6VyhFvm/8E40b8D0crXFu/mBQ9+vVV7wwX2NJjniV2tKvWqpszek4dh1/ajRmpe4QT6UV1/GiUmzgJL3FaJOQl8Wm890SdZbkQfpf12ifojj8jjAqhEYzFInDH3s6KStvpXnJfD0Kv1HIzlOoA0EmPvk/A/Nz+1TB8ZODq5E7TlPvvxDKDMsxHU1DMNtDHqeT0lWA0GZBwkqY6IqYjs3IEdax5QbV7pDrCYh6hJGH9hk2miAgDEBHTmjztGP3NMLOj15qkm940oYulDONBfybGIhPAWoLzeSAlg9erne0b0f091ZX6eushgzHNsoFhykYw8zIw9w5JGGMsgumxeoWiPYAcskaWfJkDQLdRURoHV7ZXJUZ2ClKNtjylQfz+Ya0P513GSi98vF11sCCEqo9oFGmQ2FikDBtiv7VXUibUX43SrC/rGdPrcs8Z58Vccnhfz1aW2NYrQPi+J2jKDPexbnuTLV0Y1fOYxDhbt1aqsxbveLcza9kyDngMA4qNNTxN60=
  - secure: iooKC6THUGgNalYGFmKEaj+JtfBXg16JnUiw1Gei5+eVJPcLodatbV9M7uPamWuKRxjQoGIAfs3DCjavHcKLackZ6okgdFHwIqUT3YDR968aXL5D9TMy38eLUKZXsuClCUW+KKQ7wfTAUYfRmiaPBkytTPy6nXD0F/rRwJJcDDn6rZSHFQOc+SuszU5rx/soPpsNPZeRWKEqpsxNvQ6Ft4DbgxeKGMD8OTf5dBcpOBZzg5gjUqYB/o1w05bB7s7pxUCux3Y9Lo8WNNe6B0klI90zBXZXCn8HN/C0XAsuJ0Wrnc6pyHRT2mnStXHxihlWAXF3Yx+V2gFIQKzMk96q9jl5IVyGM3LfAtZ7jZtzaIUD+TnSqChwmn93BavaoHvosSh2T3Pc9vXG+IfKYvPHPyvFg82bWbWNetwnUoKXwCALPjd33nXTtckwjV+plBJtzNRewddB94XVnYlUxVZy/OfLArzd/ybsn7xssVBFN+Yw3mUNRZai9GcnVVfrSJY04uzTCT/sFGV7KXdkOevT93ZMQJkcrh4kq3VA+fFNz5W6MfC6BHue55w1wQyyV8Rt3A5CziQEIgu1Vtp+7n9pgQXLTGamw/qH+nvP8a5BXhpteTKzqO0KFxDqO9bt3trZtI0XOCjQH/Wuaa/SK9z4uMcm9DRaOTqqwlBaTosTxGg=
  - secure: iwEVQVbp/o6yZJy7AaNyRNB9vVFlg81anVbLZBXJVge0/r0NqabMyM0VyAD6EtFr0Vl8tk6ILG2QwX8LnE89dMel1yxQYVfzTa4tcr/DnnB3yGRJmSATfZZm+D7Pan1oZAhB8qmmP5u/+AaY9+P2Fl7wYgUnYYnvPqXLn18DoLmyNjHY9SpLF3MWNYtZpWidIVnDSjtXbEw6/xI8CHEewubV25OcAeFvK8kULG/qPWk2d6p2K/xn2srjYoMjkhwO/Ydm/5ksWY3FZ1TNled0CQgXZBokCVFGQI0Nyae1bn0Q964d9L2XoJfOGvebb2Q5UOYXGP8Xias9VPZOZnvR4gfZ6thTnIPjFLBP8pRnfGKVPzzuykerbVbgbsyflj9UeIImfiwV86Pve74GB10yKX9pU6HybSq0bjYAOICbKiFDI4oSugvmS2Xyk5VXw+q5/X4rzXFb8KLCj0FzNA3Ake8PLd6frQfWxmgSe5MInUxb98PPISw8kOL/fPyY2WazJKISazlUI+sftd0vViZhizzwPVsmied/96W1s9g8qYnxEjf5loQ3Ncv2UmzRI8qApCAAL9aZTZ0X9dDf36edmRORu5Xx2ROa1rTtI7/ZxbfBWp8B3EmWbfINb10ydFcE1ILT7sKmsFEzbhYIYix0tpbu9VQQ7nDpQt7uLp5UkE0=
install:
- go get github.com/packethost/packngo
- go get github.com/richardlehane/crock32
- go install github.com/richardlehane/provisioner
script:
- go test -v github.com/richardlehane/provisioner
- provisioner -project=archivists -host=backup-RAND.archivists.org.au -env=PACKET_AUTH_TOKEN,BB_ACCOUNT,BB_KEY,DRIVE_USER,DRIVE_ID,DRIVE_SECRET -files $HOME/gopath/src/github.com/richardlehane/provisioner/service.json $HOME/gopath/src/github.com/richardlehane/provisioner/scripts/backup.yaml
before_install:
- openssl aes-256-cbc -K $encrypted_18faf0df1b3e_key -iv $encrypted_18faf0df1b3e_iv
  -in service.json.enc -out service.json -d
