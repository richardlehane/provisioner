sudo: false
language: go
go:
- stable
env:
  global:
  - secure: s4Qja+zXorDDo2kA4xOjm5EARgXPNTdIfN4PerCpPfcG0tG9wkYR/LFcyVaJgPE8r0VJ65G3f4MRyf4kwrYp/YzggWfBM3eS0kV0duSTM7Nig3cNGCZkwfJKvK4gYWZuSmiO7GYYMIfQNWuxs7P48ceLyfvBluRnI5+Kqz4Cbr0pdcSzzXYShezbJq+c//yNmhH8AKLzYyR4eXnf+ZEiQrE48W2Iya+3Tu9CyJsDWpqxUlD5A7Vxhh/DvcI08+Oq3oo8Ss8KAXtYZXu6f3K7U8gAIqgzZw5ERpt28IFZS46HaJoR2cw/TxB09weZRMQyxqXqJMu0YEBUMEJtNOLMZcLuhS7Qxd3UZNVNcHDmtEOKTYRbRO4DcdbNLBY62RyyAYWcq5eS1U8e6efaQy1iZS5nTyPYPIzSWEodBQC16lVNydgHI4nGNptnJszIZvKFVww1RBVahBYdaooqm2grjRFXHR3qHsWhwlo1+A1a4WrGmLVUBwf5+iAETz7nRDWw6gb54cyWlkQGo462xgPvN+foZ9YFTm06/26O5bf1OFkxnEXlLTnPZbCYMXoyIbpt8ivZEuhkMLR2yYVo2ZdWS97yKsr9dicsZgukLLUlw4Gg4D/06HoFPyXMNXIhUV+pVH0AcrOhgiv1wLNVl6IDSg2+foBbcyNaeBCOoLkSHf4=
  - secure: pMw8yibIvSu8lxtd+LS7p4a3a+Fh7g/INnYmGDwLW/sqCSYLiHwvleQ7QU9RF6q05H0fv245MrYtoCXrjh4/Iro3SJJMn7BTo/5nJkJo6hDjHe9x8AHrBfnt7fV/++HnxpRKviZyIM4wO6ctMRytGjmplGr6J3jPnZ/+Nhu/rEOBgDAlq21SgetgOFTqfE082uXnHKjtd/5Prfv0zPX8s31mBdsdiYk23OCSYaGR4kRB3MuQ36BjaJuFELfoB9LaluK4Ed+MMAZXOQ3VkHPNvP+MoM5+ngLQYXzHJKMB4bZohv456sza2hZ72x3SLVawrRNhUFgszmNaXWNVZlL0sFYEP/+TYATiwFfiC+7v5OMKfdsJa/2sCMD/hUqWOP8/mPMmCA68FdSWv6ESF4XCu3ZPlgQizR87MCk8O1qUc+Ojlfjf4UNAg1GrTDbMgykxcnj1tb2fE/U4Xmia9xjmv01eOtZFnkUTo4hBH95jUBEssSK8ogOcGHN93N/KdfegTeh6xs7wBMnp+wM0nd69AT6qpYVZ248kPVZvq1xc50WIOT9hs5gforGnybykXhEMEPlMvmqD1C0a/X4M3raqBbDgLeoZcVCyNfXjBWyvgEKIhJMK+vcdGJ5UhRe5bS+xRKROEBdbVuuSn6988TGMLgxrojgu70j2lzbS41aKa10=
  - secure: cSvHatuUEn7+9mCsvWkHdCrGEd4Qh2HtzesWEw9X3pb2QvL0ePFnpyfNLYMI1nTjEHDQmJOqXhi1hplDKayuO2mrRJ6HvhB1Cv3g04E/NJqQm40U4/ZeYupcs/UXzLcOaQIVr7GPq0sI0LsCfTvyFKyadoBvMcKA0hfV0aw3AIaUgH55jo1mLLKefwU1eOE0ecm+OCJxk80RsKrKmYWJsC3+ZMhGAq8+bw8lYljxvmKzm2Xi+2SmbW5bK+j+1psY6ymw/c4nutbE4Pa9PbZonp7JhuZqYcrv4cu8VyfkldLen9D3rWoSpDsGihD6rByXBwa8foxcW/8KxsxTnXzwzpDFiTDRm1u16zbKJNrMb6ptFO9ufF90dqnhuBkQdlIwFbp0W83+9nr5NBlozE6hjTKVie+K//P9c5pwdRTOca2dUOjX67WwB2uUDBPt04l8CDKp9jknKOHoK8pYNzauUGa9i9vyTghlxxfimnmk060fzt3622H2nbwbdzQNsHbEB7QF5wLgtpMcCSRTww22iKa0b+Udf8NzYDFpEjLpDWQhVo/dkgiH15OsrWOVdh0OSMYc4bGfu8gKAnmuFzw9WljIaT0nSgEyAnLaxpAdinu8rsq5v2KPWOpI0Zs22LqvuAGvsGcmhbAQ70uKFVCDI9590/pdP7YnwEB/QHlYgEY=
  - secure: TrbS3S102I4nfehVc/Y6GqNKCD+E1JeVCPCjQoNRNkNvfpCojCclfrMjLmSkhO1xgMCVV+vKe3OIFKFDonzUhTqL75ctpRUegGQObtg6R49DxJf3C12+oJi76L79mM9h1OXtau/BGgm25pB/ZmhgHI3rNAK9XITPRuXb3HOAFioC8qCU204EbnxOCX+H95k/UWZlnsyWVmp7Wgy2g+OGbuJvS8VBuvmUu+DIqNEjRONSytKQXPbXXRe0LUaT25hLi0KCOEMSI6o/+TCS5oIqmyVE8xcy27Z23rmng9hwfm6zMA1saWaX5sGCj0UEZpsVYkSaOv91ay+fR6jHQfCu8Q0Koc24gJwhm/JqseNczDjignoBbhspgOWrm+9vQwIT7rxY4vy7mTLpESvqifnk0RLHdHq2ZV2NMGqdHlX3kaerwh3bCH92zHLPUM81bzcASQOv9USQTh0dK5d1KLDaYXP/Xgj5aFka/VU3F+JZcw3i7ybX9zbtCCI6RvU/8lxdMz5CnwFoHK2lx2l+7MAvqA5xKxraxGNzne2tzmGj9OBa95CmXaSLPNXBuQqdNy8KTBbyCXIAnOYA1uY2z3SlK+5zB/d5Iyl8XmXbMBKWbmJI76XRqSNq/cTnzzbJRqwg7TJuL+pzbsgb1QNW4mzq6ESoMr4Og5/iWFcaFGSUDo4=
before_install:
- openssl aes-256-cbc -K $encrypted_eb5f4e78beed_key -iv $encrypted_eb5f4e78beed_iv
  -in service.json.enc -out service.json -d
install:
- go get github.com/packethost/packngo
- go install github.com/richardlehane/provisioner
script:
- go test -v github.com/richardlehane/provisioner
- provisioner -host=backup.archivists.org -env=BB_ACCOUNT,BB_KEY,DRIVE_USER -files
  $HOME/gopath/src/github.com/richardlehane/provisioner/service.json $HOME/gopath/src/github.com/richardlehane/provisioner/scripts/backup.yaml
