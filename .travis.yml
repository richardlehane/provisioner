sudo: false
language: go
go:
- stable
env:
  global:
  - secure: TF+oYlZTdOgW3Mmv5a8r53Dyjf605G+o7evShWtgK0erKcW56BuDL42tsGDGYTMw7dvo3P/biOG5EBwdeUH0rEJ4TCN8zVSE3iwtJGH72oDkRuSZn1DaEUsiU6Uhr4tWLM2s2R0s1WkCSKjvG0y1eQnhl/6mc3rHiVra5CIAF+JHnAfRBIp5IBLMWu9uwyLtURkUyRoD+Dc3liLPq8Y46DShhBWaF1khLCZ0b6Wl6XUBvaujG0wR2u8REy9iWETHEmLrms7h1u/97w57aecvytoPwxh4gjakKnlV/9tVxixAhC1c5p79jaVXb13gx9xiCwAjLpmsjiRYj0YWmsQWn4ZjoAK8pOfyCRx47AHzrBjJT8mmgfULc8RQ3j2Rk5bTeO05xnjPrzH6EwZxCm6ZYNdCXqIaqq9TfeRDuTG8d5+laJ4APak5l9daNjT/C8RQC+3p2mjM5FeDtf+WtMHxZpwVg9B0f2O1SD8BHPLRT5gJnNSvFSFZfdI2onicQ/ktIR6bgWRbIqM5OwlqAP8cEl8vwOYwB2v+xQ00R3R2kTzwsWE9r4gM9xeVQuMuuuMJs7lBrRXRK6knJbI9fuSOiu7N6uLpXM1TwG9+js1ZsahLPx7b1nsPIh/SknUUMQPsA6Ewle+3g2NCOafuZiubk1bPi30mJUljxSB0xcZcn8E=
  - secure: wyr+OGbr7hWFvaw8WRGPstQsTA2ahl2cTPvhoyGnXmmD1buOd2HmQZ9NgRszIPScR652B9q3pWfaEhHPMogsttSkjVvVonUu+DHnWD8b3Jgt55cr7WDH1VFumeen8UrtaDXICapueAQesZzG+rNIacxVjpBkv18IwkdsvPWvicoq2EWMYc+EHuTK84Rjg7vZ0zofbpCtrQ0vPn3lON1N1b+HGPissIstxrOG/CXKvVzOj/B+Vbe3Wf63UVuKKwxvuCpCRnG0SLVgDwwjsj71ly9J8UxWydpEyozM8slwEGd8YWpAMzFHg/pVvbTyULeY1MXfO/M6EAlR5ZuUQrLcLwHjz3/YexBSTyVV7TZzw/MqhO9x9oTF6RC8YYXiPJgwFx5+cIKysTVjEfXA+CCNoGW3d61VSYi+KndHvCRc8TDRSAHLKTG8LDaNaQb5TlhDfXl9uk4qGFWO/HmC4uDaQtyWNG7gmvUm58ZmGWJ9/J4tqOBZCyIIbeZcc9qu1Daja5W2WPw9AdE9q3fTQCD5JQXnCiXDY+Afzqn42eRs8y/b+qju/yHweFBzNUDYltgtPk8guIWAHAjFVJPMhhGeVQGjiTPcz+2qcomAC9+4y+2Cj/OHKvGBCh6a72ZoShkEdFLK3LKrGg9WEtabaXo/MUBlC/aD13bwM5DO2CLzElk=
  - secure: ktxPZGjhocne9W7mpmIVlhu+01lyccU8ahnHK5ESTgkZRv78vF8Ch1bf4DumjbFkFiaiItG0SB8vaLHnpn/l6A6Lstw8JkMBFyCRX0kp1qH4o2maGD5pLnAyDWyLss1WI5xCuXzINOAG9XE1Djzaer4fQa7JBOMartZWCmHoU4dNDzear/+06gNE+xnILhflKsg3KXG3uMhGdi4rXtaEyB0NPwgFLeTkss4a3UDrDEftGNJidukxx6HU7uZHviI4aRf1MbvM/XRBA5IepsXp/YuDgks3q1x5MBX+B+W0Kxs7OOrh4dRbehKyZVVNJ4+Ul8EO9g0X7huqwZOATdNN+aALYn3XF/cuLtVkK6S57OfznsIS/psQn8McCqCAaI0l9cTYKbmHX7baAJxDRBJSWVjPpngQLiZcMdghOn/pewNoZbsqYKi0ukwPWQIUpSoLRWogUDTcYhz+sAUCEB94cGHeZigg3lnI0vygIW9dnUkhJNPPlUcI1w3wIUVNkPwVUqG0P5rwgBem1FNi27psMX8XFHViNxCUl1W3CXYXlq50YtdbPQpP6GGwtLDvaTid9SSyOerUrb4mbzJ7C4qnR/6qC/pmhuniSJWFZ9q0G6lGdwOrYhSIpPhdLdOCxUev8DmtShUzImO8SifcFj5h8A+9pkq5qRTsZUtXIk0j3wc=
  - secure: MoR4R1u1lg7ILmrJuykWTSOBj6exEOIPttFwkNbJ25pUPdwCmu209U8jO840jkNa+Wir19s680xOkWRqKlR1cOSXs19kBxLEUGKg95Y3QBSf4bdcMfk6AsLRiojkMex1L3k3wh3VZ3j9Xlql+XzqSfX7tEhI6n7puZ+t4KwZPVtmoeetzNg85jjsNMtb6/8Vr4LzbQs2yLp1uO1dXY6mGUQkj+b/LYJqorZOL/BbW+Zontl2O5WCwKTO3n3ORW01XtySY+W4Pz7Wj+rLCaLWYmLD/P9WxhKqeq8IpsQfDwRW8kQ4aoJcRDlbAuqZH4Am3MKCEcTjVBH86MTjcd5G2pmRw0wlvJIN6fYymbEqRu+IT8rqhayVEfJ2Gm8/EIDlkFLqDCBQQ4Ug8tz66v3pX985BFIDVdcCaR0RQnpUZh5nJ0ipNb0Gp/OYj+Rr2ZFduntN0PvVjDIqfwrpHtJ27om3IadeM2DjsgevrixXN9aFwko2XZWdzKlUkqAW3xkFldkxugZkXTr1Vq0OrB+ea/curIE6EE22YE9ciYbs/WFzjjel03klqTnq4YrxiKmYNDlgINJXUaobdEos4hCglcl0WWcCDQks5mga2qPwWZyILXMkE4/3m8w3FwXsIGFn4PB96QLV3Ol5O2UcnqBYO+V814t0m7HyvUivgkhnFpw=
  - secure: kqjtAr75QfOHWIZXI7ZNjHpK9UVUdMkrJZAEBi3iIuM4PAy0gkY8kzxqVZ9qc5JxHHi6+GjohaVhp7qPUcSlugvJeRidJ/q1LO1a80pV3VDHUYXygdGMpy639KWgniJCuyPAC3pIQX5huGKhjVvQct+L+vO0RufhH3O4dz5DqdlM7LFKbyuyssmS6YN78Ps5UdA7D20CjAsTdQ+XgSPFcqNi7z1rP3DG9c+IVvZB+NccJJA6qj8iDC/hsxdTBF8lAyNpE/FCzjSuErcoey4UYUSJIUq8MeG+oJZ4sL0CTWJmSc5WHbmjoizdvBWye1MzsUcraztMz3vgo3xzr6N4XRJAd0hEyrKZz1MukLOZnCkI75yc6vBk0LnyTs+D6D/jgyqFcW//R2fgjd6s2jaFT64EI3e47vgVfApdzUFSVYrSyo40VbM7o+j/rcv1i7YTr7SBEjC3n9pTDHQOGun2Z9YS91jnSobZorCEggN9x9HGBN0f5jfVXQZgfx09qW8arYKnnCXFX8Gmrx+KMeD5fRoBhfY0ae3a5L9KzPssrruajS3hkC5ImjPoTbbT+qPLCuZF1sn/I+wEg0r8nR3Oca6qqhWmQDLZwQX3Yb2Qqw/iXMq8dddZYSaakZ63TJ/Fb+ZVZv+R4BaE5NXj8XS8mnHbHOTzctCAdzYhlqPPDnA=
  - secure: voR43G5Deyxk3ZPIST1F6BfBC9e+dwvZjj7Ogf/UOYezhlhMtTEV1htj9iJlWbpqAAErdQQWgdWtTqdz5VuOl55JVod8qxFkYDxs6w4v+6qNZsoz3/CfGoVzqYC4D82CwfSSG/U5qQL9y/YdLrWAmyIQ98tfpxEBAVvK1yhd94fEAV+n4TwRbcYXRiD5vEGLqVMHtQGtWyOXUVKzcwea3ZTAHFZhci5om2Vs1b8sii34yT+IvO6/Auyl+yvABRRMeyCDoTv8ctj/nKWzhg/VGBTaPBy/HL/CINWhf4qjYYeuN/rYw6vkMHUyRF7Tkk/9Ka8QctBPYlUIvOwZ0Zh9hDrlEt8x+bkI4kbFVelZn//13cyXXBIb2cnmalxAxbjUi5msBId+vtKgmYCKpx61YJQaMi5igZy7KlOtaMc1WRroY+8dsp7NBBg/GJj2c4Bqz0GnlqAtZJTrTfQxRpxk5LUNAhIKCC39iodFDY2iScAOpHcbecn0HQTixilB2sj06bEZ8vDFr3I/fU+hEl/K5br44S0L1GHazND0GFGzpD8Vvuijuxi6mA7DglEcIFa4vGnsT36BQIOcx8a0YJyLSgSlC5/TNx1sna+ZW6W49cOV9Ozp3445nzTEntqSB/QGW4B4tQ5QHnylGiuv06rkm+0LxFZwXEfdzWT5NMIxtCE=
install:
- go get github.com/packethost/packngo
- go get github.com/richardlehane/crock32
- go install github.com/richardlehane/provisioner
script:
- go test -v github.com/richardlehane/provisioner
- provisioner -project=archivists -host=backup-RAND.archivists.org.au -env=PACKET_AUTH_TOKEN,BB_ACCOUNT,BB_KEY,DRIVE_USER,DRIVE_ID,DRIVE_SECRET
  -files $HOME/gopath/src/github.com/richardlehane/provisioner/service.json $HOME/gopath/src/github.com/richardlehane/provisioner/scripts/backup.yaml
before_install:
- openssl aes-256-cbc -K $encrypted_18faf0df1b3e_key -iv $encrypted_18faf0df1b3e_iv
  -in service.json.enc -out service.json -d
