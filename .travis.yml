sudo: false
language: go
go:
- stable
env:
  global:
  - secure: c3JlvToFeWUcGUMrqM5Po8oZEWinUsgfaOxo6ag+n72D9hcw5ds2md9WglwFt66FxVj9C339bRG3TdVzBgdmGO1A11uG9+Le5VvJc/pkipdf1Vp/6P4sufyQPESzXfmWNc2Ovx0Ap/4BBZ90xL1Jd7I2b9J3KXLdZbrtajimpIIncnid+e7wJ+YlOT3a96g+hXfy2djz0ezT9oIT8a6naAyckBRX3TzeysLQtm8C/jWT9ajIYW7EDko3sdkYM3BdGcHGWHRjhTZt49637Qzx9m+YxPjJPaBibPJfU3JXYXt+/IjpkqcStdQeWYAZvXBaEG1TUZmfbzVRZiiapjbiwmHIK5Rrc2NDPMGDrUG6A4Bk+4cPRdMVMLCKmRiDGj0YNnXhAu8o+CoEd3SEmkp2IfMtAlftR2elnC7WMKAibjmKWgOadJZcMdv5828T/y5Xy8cz3hJtKUCIhJyI69fndDNQiWlwbcIfU4nYlv7eSTppJKjq+fFmYaAZLDCbGtSwMEcHsbjthIDyhMJPu+VTw04JCX/CZ61ZCJhtVzNHETQ8icx+RcxUWFuarYNKUaOA0xBvuhec3Tk3u/lFoXeRPZolWbPpi8kIeuIQ6fXHe4UXazEOf0HmE2xYXfbf4teuC8FIMyQf+xM7bSUTQlV/uoZFJPgo0fYwKyq7BYQAW5w=
  - secure: OoEc7WzwKr2gthudGNnHpo0rZYey/hcCKt6CkdkzYrMAUsTUhnfuWVOrfG9aJgXQJU9tq9bwjipI7I2V4yEwqch/3GltBTGPYOP8sM1QcI6IyLVeMqMSIVZo+mqo+lk8gKfRl6GHD3C6e48g9xkvfKTncE1+p//lqNHuwASTReNnAQk/3L5oo1KG4+7vp7Yi7GcPjyvbTufiYe89rhMTaY50I4qj5yO7cG8M8i8KSfIQN5TaX4gf+DkV4+uwfIHt8sdk5+AyBXSsIckCP7EMXvYsSmCjJf59WyRkFxoqtXMhUbFPy5HJe7QUnjJdXxEnW6ZUDETecppxx2GQs5t0fd0iZ79QfdMThxo/bCBURA3zQAC9Nu6/U7r5yAEwe2RiVrBoX0mtmdIBGSDaKJlQkREu1+bLTuvydOYjVbOGd3+Ozmb2Cado/wN/p3icx2dZctRpOjs63HzjNgP4k4JCLgcPraboP7Q1DMXQbsJ/R/4u66q8M8I/437eIvYHrgA1xzX0WcACaf9ePEYbjB9EKiIwXDwM5a/MMbS27fKE5JB8rxl179r1vj9sPFbV6rWcBNz9VIzCZbto1P34RCo9HnmgPcHipnpWylZtKYByTzxqu7lvAAsF+TkZplU+uo/l65HXy7t7NIjfmqgzRtBUWV1juQ3dfB2oLGr1vwBoHXE=
  - secure: OIja5M/H4axMEj42Lc8tze0q6cbyZvoDdjJQttakJ2VLeH72SHtJCbttBF3QTpLkhftuckWdLnUxPh+ibHQZsiwEwZaZ4MzVfLOkCQ43UAX29qLH0VjmWCgx/m4Ch4WzmeEwdnV25amC7kgGeYRc3AZMs76LUyW9Eg2X/BPiUzhc1PqtwviWCFcPewCDpJorPZ17+Tc94EmJ5IyOtrSxMZ3Jrz8b1MUdbpaq/bFgh92Rtf9tfc26L8LjOmRsWyq2qow9QQyiBGmd5zATEMpKbpxJWuSPTDMCzO46MulbFcGJNOl2Mo4HV73cgvIs2jY6KkadWDo/SJ5nfxSrShsSv7U3eKbFWzRZK0aZKaTCKjmmi7zkSO1wcOykGT2fONmouqmSub+3CZAvHHLXH2wRBdx3PmKs7TimL4Nh5L4d7ti0uHgKpS8kMyaQkLnsTeddLthp34XbiT/JZFeK4vJWd0Vvz8gt5k3/swDj18aNIDGKzWM+sBmjs64+woIKRtG0CjgS8ZTUgr9R7cYAwaQgOsCuHKiNZDlp2wP1IvBZ1UshHY1ej8Hhe73AWaWekjT5WTvle++Wx3l8ymme+XxbLQ8YmUsV19M/wOyUN93/98EVWKLr1yD8WEApSMxu9XuThJk6pd0gQ1RyFlTrXwdw9Tr+zBWVhOYmCi4mZaicI3s=
  - secure: BQ7Z22Qd2XuiILldZ1o+PgPmbQMuHq9ypHo0bV63AVm+lHGfppG+utcPlWa5vOqe9Bkr3UvsnhcgRb0T8mR75GOs1A6qM/CKbnLsPHxr4pi+pRNS0Uxl0IKzoP97W2nRE31IHLwSvlRKgeNEBLfQ1O1gENlOfPDEtyDQDmrwaHdIdXC3AGC6Z1k15txERyoQKFfvkWmDZ8D/rjWU6l6Qeuv57BzNv05ie/9q75l6RVj5i4d7gn2OVWAM6hNhcx7/0hajp7JXe8qtn08NEBRNUx6y+08pu6dnl2yz6jKohLVdbAhAsLK6Ju7lKEsS3mTC4rrHkumOtwUgPS82E7gFGNgoqYO+7SdkdGv+YSjjlC5RyMqGZ+sCTxdBvKc/y+zaxdh6fUcCHQBPhZuOf9PvNmvWUz43WhKxpHIg6wNIQHl/qVPdxmkDgSxDwZnCRjFVN0+ImR/LB4A0TcznJpuYezlF69c/IBTVwY0ITm95FJWXsL1jRXRjg0JHFa5S7+eTWSxJJg1sEBZmTBnuIxqaS1G3WGuq9Uf/BMGWnMcbYUqflta2MI620+Z0h9YOcX+PCsjYQ4NgeQPKXNjdI7tNjgcZkzoJ+efQjzBJCbmY0cKMXLGqIPtMarGdW03cWGe/OU7eaFyGRQvbxdLOMpiS9mozHykfKMlNHVeQaBGqCMA=
  - secure: gK0TwdXwxKeAd6Ndld9XZtCHM0+943aERllQFriU2o8H0ZX7DCdS37AF7UrXrQSwcala2yG8+GtJUEJD7At5LOMVuMxayz1UsBxfw6No9u/XfxW+73EbKW3ep4hbYxwokh4jMIbxRXjL6k6iHXkFLW/QRG9PsGJkyQatsAR4K60c5Xd09ywEZM1VKFw7Jj0/3z3cj8gfVDkefL5vI02gJh5PWi424WQHOz2qHYMT4BmzDMU4KEYVo2TFk6pTLdoTZi9KL1snCqWUlNvg4qla119jBJYJ0VjfI0QjZCeOH87LGOKPsAtyXA8LyFuTrZa0u8j1b7OHYVTF9VG2fuZE18kj3QIZbPS89JjpGQful231ItUMYK6TdVzDSVd79zld6RqJqqDsD98Wj6xiMMYd7KghoMOCXhlocGb7P1rj4N9MwaEEKp/FDNsHHATj7+FINnGyKccXLe5UzJCNxO+5JELc+0UAGPy1GwMR8GmKN/cDuAqBpAGqQzaA2SOLSGclaOIkppsnp8WCE9KCo5MYklGObi7T/akzKHMpXbb4RExKNFsh/wi5KCQISsT0LHbRpZdsRPQERXhW5GE07Im4Tpvka7KI6NiJ5CCIe41nf+c13+abU7RvRDtjFqn3KC7z+4N6ZTeIsygFk5gjGFURS9/QMmixd1WN7x/X7oO5HJs=
  - secure: L4eis02rH/YGt8qiX9QaoyDFL1tr/shKlPEE1ZKaC2puWmqz9Y+UysUd6K30o/Ab7yzd8q5far32b87ReH/BCuoMWhjIs/jvqujmEAZvsBpEyvxHb82L/5OP69p6r9ucap6NH/Ks+9x+k0M8DzljMUyvb+GR79s+PnZ1HfXyAeDuuSB1M/g76JHRE+ig/zLbcODw1L6eBuymAY324pEEmyadEkTNxhp7SkpxlCbD7pEl8hc/vsxzxj9hu+vN/w0cbFWxLDVdoZusLbA4iLB8YZS9rF5WxpNvxLMU6kmahRwZ3KOuo5wcj8wm+5u6H55VrpTXZdRxLYNWY44vVPRL994qG53YSimwz/UcpfArrZB6NHGB+TI6/kHjskZWrW8S0Ei7J3/4ZBb4dKimMmgpxBNURHVwGvoMJ5ciVoJyonfhbXfGwHmd0ZJmG/K4/WbthLKCqDZxKweUM3ebdXzWsMGrZ48l9lWyrfcfB6CHtATWjrp/ynnhCfAGDwCZeHSKb1iwKWi0EUTpL0/U1bdBx8AxHqmilrV0D+bL4nbfBbQJXCnbCdN1E5CeF48wXv/3SqgF6Cz2I4Y4ygUEZVeU0qSmg85qg4vxiABL0YZYpLTB5gJJSPISlZWiIKnxiLPS/efIRkrqlIDg2/p0tOSie4ezQohVr3cGkzXzaGSmgWY=
install:
- go get github.com/packethost/packngo
- go get github.com/richardlehane/crock32
- go install github.com/richardlehane/provisioner
script:
- go test -v github.com/richardlehane/provisioner
- provisioner -project=archivists -host=backup-RAND.archivists.org.au -env=PACKET_AUTH_TOKEN,BB_ACCOUNT,BB_KEY,DRIVE_USER,DRIVE_ID,DRIVE_SECRET
  -files $HOME/gopath/src/github.com/richardlehane/provisioner/service.json $HOME/gopath/src/github.com/richardlehane/provisioner/scripts/backup.yaml
before_install:
- openssl aes-256-cbc -K $encrypted_18faf0df1b3e_key -iv $encrypted_18faf0df1b3e_iv
  -in service.json.enc -out service.json -d
